<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EngageSense - Real-Time Engagement Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Roboto', sans-serif;
        }
        .scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .scrollbar::-webkit-scrollbar-thumb {
            background: #4a5568;
            border-radius: 4px;
        }
        .highlight {
            color: #3b82f6;
        }
        button:hover {
            background-color: #2563eb;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col p-4 scrollbar">
    <header class="text-center mb-8">
        <h1 class="text-4xl font-bold text-white">EngageSense - Real-Time Analyzer</h1>
        <p class="text-gray-400">Analyze real-time audience engagement with AI</p>
    </header>

    <main class="container mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- File Upload & Recording Section -->
        <div class="bg-gray-800 p-6 rounded-lg shadow-lg col-span-1 md:col-span-2">
            <h2 class="text-xl text-white font-semibold">Audio Input</h2>
            <p class="text-gray-400 mb-4">Upload an audio file or record in real-time.</p>
            <div class="space-y-4">
                <input type="file" id="audioUpload" accept="audio/*" class="block w-full text-gray-300 bg-gray-700 p-2 rounded-lg" aria-label="Upload audio file" />
                <button id="recordButton" class="bg-blue-600 text-white px-4 py-2 rounded-lg w-full" aria-label="Start recording audio">Start Recording</button>
                <button id="stopButton" class="bg-red-600 text-white px-4 py-2 rounded-lg w-full hidden" aria-label="Stop recording audio">Stop Recording</button>
                <audio id="audioPreview" controls class="w-full hidden" aria-label="Audio playback preview"></audio>
                <div id="progressIndicator" class="w-full bg-gray-700 rounded-full h-2.5 hidden">
                    <div id="progressBar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%;"></div>
                </div>
            </div>
        </div>

        <!-- Engagement Levels Visualization -->
        <div class="bg-gray-800 p-6 rounded-lg shadow-lg col-span-1">
            <h2 class="text-xl text-white font-semibold">Engagement Levels</h2>
            <div class="chart-container">
                <canvas id="engagementLevelsChart" class="w-full mt-4"></canvas>
            </div>
        </div>

        <!-- Overall Engagement Visualization -->
        <div class="bg-gray-800 p-6 rounded-lg shadow-lg col-span-1">
            <h2 class="text-xl text-white font-semibold">Overall Engagement</h2>
            <canvas id="overallEngagementChart" class="w-full mt-4"></canvas>
            <p id="overallEngagementScore" class="text-3xl font-bold text-blue-400 mt-4 text-center">0</p>
        </div>

        <!-- Engagement Trends Visualization -->
        <div class="bg-gray-800 p-6 rounded-lg shadow-lg col-span-1 md:col-span-2">
            <h2 class="text-xl text-white font-semibold">Engagement Trends</h2>
            <canvas id="engagementTrendsChart" class="w-full mt-4"></canvas>
        </div>

        <!-- Recommendations -->
        <div class="bg-gray-800 p-6 rounded-lg shadow-lg col-span-1">
            <h2 class="text-xl text-white font-semibold">Recommendations</h2>
            <ul id="recommendationsContainer" class="mt-4 text-gray-300">
                <li>Loading recommendations...</li>
            </ul>
        </div>
    </main>

    <footer class="text-center mt-10">
        <p class="text-gray-500 text-sm">&copy; 2024 EngageSense. All Rights Reserved.</p>
    </footer>

    <script>
        // Chart.js Setup
        const engagementLevelsCtx = document.getElementById('engagementLevelsChart').getContext('2d');
        const overallEngagementCtx = document.getElementById('overallEngagementChart').getContext('2d');
        const engagementTrendsCtx = document.getElementById('engagementTrendsChart').getContext('2d');

        const engagementLevelsChart = new Chart(engagementLevelsCtx, {
            type: 'radar',
            data: {
                labels: ['Physical', 'Emotional', 'Mental', 'Spiritual'],
                datasets: [{
                    label: 'Engagement Levels',
                    data: [], // Dynamic data placeholder
                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                    borderColor: '#3b82f6',
                    pointBackgroundColor: '#3b82f6'
                }]
            },
            options: {
                scales: {
                    r: {
                        ticks: {
                            color: '#fff'
                        }
                    }
                }
            }
        });

        const overallEngagementChart = new Chart(overallEngagementCtx, {
            type: 'doughnut',
            data: {
                labels: ['Engagement', 'Remaining'],
                datasets: [{
                    data: [0, 100], // Dynamic data placeholder
                    backgroundColor: ['#3b82f6', '#2d3748']
                }]
            },
            options: {
                plugins: {
                    tooltip: { enabled: true }
                },
                cutout: '70%'
            }
        });

        const engagementTrendsChart = new Chart(engagementTrendsCtx, {
            type: 'line',
            data: {
                labels: [], // Dynamic time intervals placeholder
                datasets: [{
                    label: 'Engagement Over Time',
                    data: [], // Dynamic data placeholder
                    borderColor: '#3b82f6',
                    backgroundColor: 'rgba(59, 130, 246, 0.2)'
                }]
            },
            options: {
                scales: {
                    x: {
                        ticks: { color: '#fff' }
                    },
                    y: {
                        ticks: { color: '#fff' }
                    }
                }
            }
        });

        // Audio Recording & Real-Time Progress Indicator
        let mediaRecorder;
        const audioChunks = [];
        const recordButton = document.getElementById('recordButton');
        const stopButton = document.getElementById('stopButton');
        const audioPreview = document.getElementById('audioPreview');
        const progressIndicator = document.getElementById('progressIndicator');
        const progressBar = document.getElementById('progressBar');

        recordButton.addEventListener('click', async () => {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            mediaRecorder = new MediaRecorder(stream);

            mediaRecorder.ondataavailable = event => audioChunks.push(event.data);

            mediaRecorder.onstop = () => {
                const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                const audioUrl = URL.createObjectURL(audioBlob);
                audioPreview.src = audioUrl;
                audioPreview.classList.remove('hidden');
                stopButton.classList.add('hidden');
                recordButton.classList.remove('hidden');
                progressIndicator.classList.add('hidden');
            };

            mediaRecorder.start();
            recordButton.classList.add('hidden');
            stopButton.classList.remove('hidden');
            progressIndicator.classList.remove('hidden');

            let progress = 0;
            const interval = setInterval(() => {
                if (progress >= 100) {
                    clearInterval(interval);
                } else {
                    progress += 5;
                    progressBar.style.width = `${progress}%`;
                }
            }, 500);
        });

        stopButton.addEventListener('click', () => {
            mediaRecorder.stop();
        });

        // Update charts dynamically (example placeholders)
        function updateCharts(data) {
            engagementLevelsChart.data.datasets[0].data = data.levels;
            engagementLevelsChart.update();

            overallEngagementChart.data.datasets[0].data = data.overall;
            overallEngagementChart.update();

            engagementTrendsChart.data.labels = data.trends.labels;
            engagementTrendsChart.data.datasets[0].data = data.trends.data;
            engagementTrendsChart.update();
        }

        // Simulate dynamic updates (replace with real data logic)
        setTimeout(() => {
            const mockData = {
                levels: [8, 9, 7, 6],
                overall: [80, 20],
                trends: { labels: ['0:00', '0:15', '0:30'], data: [50, 60, 55] }
            };
            updateCharts(mockData);
        }, 2000);
    </script>
</body>
</html>
